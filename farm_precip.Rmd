---
title: "Farm Precipitation Trends"
output:
  html_notebook: default
  pdf_document: default
---

```{r, message=FALSE, echo=FALSE}
library(tidyverse)
library(lubridate)
library(forcats)
```

```{r, message=FALSE, echo=FALSE}
precip_2017_data <- read_csv("farm_precip_2017.csv")
```

```{r, echo=FALSE}
# Clean data
precip_2017_clean <- precip_2017_data %>% 
  mutate(date_2017 = mdy(date_2017)) %>% 
  mutate(month_2017 = month(date_2017, label = TRUE)) %>% 
  mutate(precip_cat_2017 = cut(precip_2017, breaks = c(0,.5,1,2,5), 
                               labels = c("<0.5", "0.5 - 0.99", 
                                             "1 - 1.99", "2+"), 
                               right = FALSE)) 

summary_by_month <- precip_2017_clean %>% 
  group_by(month_2017) %>% 
  summarise(sum(precip_2017)) %>% 
  rename(month_sum = `sum(precip_2017)`)
```

```{r, echo=FALSE, fig.width=10, fig.height=8}
# Bar Plot
precip_2017_bar <- precip_2017_clean %>% 
  group_by(month_2017) %>%
  ggplot() +
    geom_col(aes(x = month_2017, y = precip_2017, fill = precip_cat_2017), 
             color = "black") +
    labs(x = "", y = "Precipitation Total (inches)", 
         title = "Three Oaks Farms Precipitation, 2017") +
    theme_minimal() +
    theme(axis.line = element_line(size = 1.2), 
          panel.grid.major.y = element_line(size = 0.5, color = "black"), 
          panel.grid.major.x = element_blank(), 
          axis.text.x = element_text(size = 15, color = "black", angle = 15), 
          axis.text.y = element_text(size = 14, color = "black"), 
          title = element_text(size = 17, color = "black"))

precip_2017_bar
```

